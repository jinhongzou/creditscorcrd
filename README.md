 

# creditscorcrd

## 项目简介

**项目名称：** ScorCrd  
**项目简介：** ScorCrd 是一个专为零售银行部设计的评分卡开发工具，提供从数据加载到模型评估的完整流程支持。主要功能包括数据加载、样本分析、WOE 转换、特征表现分析、模型评估等。  
**适用场景：** 零售信贷评分卡建模、风控建模、特征工程、模型评估等。  
**项目链接：** [GitHub项目链接](https://github.com/jinhognzou/ScorCrd)  



## 评分卡建模的步骤介绍

### 步骤 1: 数据准备
- **数据收集与加载**：使用 `数据加载` 功能上传原始数据集（如CSV、Excel等格式），并根据业务需求选择是否进行抽样处理。
- **数据清洗**：初步清洗数据，包括处理重复记录、异常值、缺失值等。
- **数据划分**：将数据集划分为训练集、验证集和测试集（如 70%:15%:15%），确保模型训练与评估的可靠性。

### 步骤 2: 样本分析
- **数据结构分析**：查看字段类型、取值范围、变量含义，确保对数据有全面理解。
- **缺失值与异常值分析**：识别并处理缺失值（如删除、填充、建模处理），分析连续变量的分布，识别离群值。
- **目标变量分析**：分析目标变量（如是否违约）的分布情况，判断是否存在类别不平衡问题。
- **变量初步筛选**：剔除与目标变量无关或信息量过低的变量（如唯一值、常量、无关字段）。

### 步骤 3: 变量筛选与处理
- **特征探索与筛选**：
  - 使用 `特征表现` 分析功能（如IV值、PSI、WOE分布）评估变量的预测能力。
  - 保留IV值较高的变量（如IV > 0.02），剔除低预测能力或高共线性变量。
- **变量分箱（Binning）**：
  - 对连续变量进行分箱处理（如等频、等距、卡方分箱），提升模型稳定性和可解释性。
- **WOE转换（Weight of Evidence）**：
  - 将分箱后的变量转换为WOE值，用于逻辑回归等模型的建模输入。
  - 同时计算每个分箱的IV（Information Value），评估变量重要性。
- **变量标准化与编码**：对WOE转换后的变量进行标准化或直接用于建模。

### 步骤 4: 模型构建
- **模型选择**：根据业务需求选择合适的模型算法（如逻辑回归、XGBoost、LightGBM等），评分卡通常以逻辑回归为主，因其可解释性强。
- **特征工程整合**：将经过WOE转换的变量作为输入特征，构建建模数据集。
- **模型训练**：在训练集上训练模型，调整参数（如正则化系数、学习率等）以避免过拟合。
- **变量系数解释**：对于逻辑回归模型，可输出变量系数，用于构建评分卡公式。

### 步骤 5: 模型评估
- **性能评估**：
  - 使用 `模型评估` 功能分析模型在训练集、验证集和测试集上的表现。
  - 常用评估指标包括：AUC、KS值、PSI、Lift、准确率、召回率、F1值等。
- **稳定性与区分度分析**：
  - 分析模型在不同时间段或不同样本上的稳定性（如PSI < 0.25 表示模型稳定）。
  - 检查模型的区分能力（如KS > 0.3 表示模型具有较好区分度）。
- **模型调优**：根据评估结果调整特征选择、分箱策略或模型参数，提升模型性能。

### 步骤 6: 评分卡构建
- **评分卡公式设计**：
  - 基于逻辑回归模型的系数，构建评分卡公式，通常为：  
    $$
    Score = \text{Offset} + \text{Factor} \times (\beta_0 + \sum \beta_i \times WOE_i)
    $$
  - 其中 Offset 和 Factor 用于将分数映射到业务所需的分数区间（如300~850）。
- **评分卡生成**：
  - 将每个变量的每个分箱对应的WOE值转换为对应的分数。
  - 输出评分卡模板，供业务人员理解与使用。

### 步骤 7: 评分卡部署
- **模型打包与部署**：
  - 将评分卡模型部署至生产环境，支持实时评分（API接口）或批量评分（脚本/ETL）。
- **评分卡监控**：
  - 建立评分卡监控机制，定期检查模型性能变化（如PSI、KS）、评分分布偏移等。
- **模型迭代更新**：
  - 根据业务反馈和数据变化，定期更新模型和评分卡，确保模型持续有效。

### 附加建议：
- **文档化**：整个建模过程应形成完整的文档，包括数据字典、建模报告、评分卡模板、评估结果等。
- **合规性审查**：特别是在金融风控场景中，评分卡模型需通过监管审查，确保无歧视、可解释、可追溯。


## 技术栈

- R语言
- Shiny
- Shinydashboard
- ggplot2
- scorecard 包

---

## 安装和运行

### 安装依赖库

```r
install.packages("shiny")
install.packages("shinydashboard")
install.packages("ggplot2")
install.packages("scorecard")
```

### 运行项目

```r
library(shiny)
runApp("path/to/ScorCrd")
```

---

## 功能介绍

### 1. 数据加载
- 支持通过 `fileInput` 加载本地 CSV 文件。
- 提供抽样比例设置，便于快速测试和调试。

### 2. 样本分析
- **样本概况**：展示数据集的基本统计信息。
- **源样本数据**：查看原始数据样本。
- **训练样本清单**：展示训练集样本。
- **测试样本清单**：展示测试集样本。

### 3. WOE 转换
- 使用 `mWoebin` 函数对变量进行 WOE（Weight of Evidence）分箱转换。
- 输出 WOE 转换后的数据框，可用于后续建模。

### 4. 特征表现分析
- **特征重要性**：展示 IV 值（Information Value）和随机森林方法计算的特征重要性。
- **特征表现图**：可视化特征分布、WOE 趋势图等。

### 5. 模型评估
- **模型稳定性**：通过 PSI（Population Stability Index）评估模型稳定性。
- **ROC 曲线**：展示训练样本和测试样本的 ROC 曲线及 AUC 值。

---

## 使用示例

### 数据加载

```r
g_dt_file_tmp <- browse_dt(isolate(g_var$browse_file), mStr2c(isolate(g_var$charcolname)))
```

### 样本分析

```r
mod_dat <- mSample(g_dt$g_dt_file, isolate(g_var$sample_rate))
```

### WOE 转换

```r
bins <- mWoebin(dt = dt, y = y, print_step = 0)
```

---

## 贡献指南

我们欢迎社区贡献！请遵循以下流程：

### 代码规范
- 使用标准 R 语言编码风格。
- 保持函数命名清晰、注释完整。

### 提交流程
1. `git add .` 添加修改文件
2. `git commit -m "Your commit message"` 提交更改
3. `git push` 推送至远程仓库

### Pull Request
- Fork 本项目，创建自己的分支。
- 提交 PR 时，请简要说明修改内容和目的。

---

## 问题反馈

如果您在使用过程中遇到任何问题，欢迎在 [GitHub Issues](https://github.com/jiinhongzou/creditscorcrd/issues) 中提交反馈或建议。

---

## 许可证

本项目采用 MIT 许可证。详情请参阅 [LICENSE](LICENSE) 文件。

---

## 作者

- [jinhongzou](https://github.com/jinhongzou)

---

## 致谢

感谢以下开源项目的支持：
- [shiny](https://shiny.rstudio.com/)
- [scorecard](https://cran.r-project.org/web/packages/scorecard/index.html)
